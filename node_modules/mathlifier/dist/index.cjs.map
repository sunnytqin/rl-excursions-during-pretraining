{"version":3,"sources":["../src/math.ts","../src/display.ts","../src/mathEnvironments.ts","../src/typesettingUtils.ts","../src/htmlTex.ts"],"names":["katex"],"mappings":"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","sourcesContent":["import katex from 'katex';\n/**\n * Renders inline math\n *\n * Takes a TeX expression and outputs a HTML string for the rendered math\n *\n * @param x TeX expression to be rendered\n * @param options defaults to `{wrap: false, throwOnError: false}`.\n * `wrap` is a custom option where the default `wrap===false` disables line breaks by default by adding braces to the TeX expression.\n * All KaTeX options are supported, and with the exception of `throwOnError` are left as default\n *\n * @returns HTML string generated by KaTeX representing inline math\n *\n * With default options, is equivalent to calling `katex.renderToString('{'+x+'}', {throwOnError: false})\n */\nexport function math(x: string, options?: KatexOptionsInline): string {\n\toptions = { wrap: false, throwOnError: false, ...options };\n\tconst xString = options.wrap ? x : `{${x}}`;\n\treturn katex.renderToString(xString, options);\n}\n\ninterface KatexOptionsInline extends KatexOptions {\n\t/** whether to wrap LaTeX markup with curly braces to prevent line-wrap */\n\twrap?: boolean;\n}\n\ninterface TrustContext {\n\tcommand: string;\n\turl: string;\n\tprotocol: string;\n}\n\nexport interface KatexOptions {\n\t/**\n\t * If `true`, math will be rendered in display mode\n\t * (math in display style and center math on page)\n\t *\n\t * If `false`, math will be rendered in inline mode\n\t * @default false\n\t */\n\tdisplayMode?: boolean | undefined;\n\t/**\n\t * Determines the markup language of the output. The valid choices are:\n\t * - `html`: Outputs KaTeX in HTML only.\n\t * - `mathml`: Outputs KaTeX in MathML only.\n\t * - `htmlAndMathml`: Outputs HTML for visual rendering\n\t *   and includes MathML for accessibility.\n\t *\n\t * @default 'htmlAndMathml'\n\t */\n\toutput?: 'html' | 'mathml' | 'htmlAndMathml' | undefined;\n\t/**\n\t * If `true`, display math has \\tags rendered on the left\n\t * instead of the right, like \\usepackage[leqno]{amsmath} in LaTeX.\n\t *\n\t * @default false\n\t */\n\tleqno?: boolean | undefined;\n\t/**\n\t * If `true`, display math renders flush left with a 2em left margin,\n\t * like \\documentclass[fleqn] in LaTeX with the amsmath package.\n\t *\n\t * @default false\n\t */\n\tfleqn?: boolean | undefined;\n\t/**\n\t * If `true`, KaTeX will throw a `ParseError` when\n\t * it encounters an unsupported command or invalid LaTex\n\t *\n\t * If `false`, KaTeX will render unsupported commands as\n\t * text, and render invalid LaTeX as its source code with\n\t * hover text giving the error, in color given by errorColor\n\t * @default true\n\t */\n\tthrowOnError?: boolean | undefined;\n\t/**\n\t * A Color string given in format `#XXX` or `#XXXXXX`\n\t */\n\terrorColor?: string | undefined;\n\t/**\n\t * A collection of custom macros.\n\t *\n\t * See `src/macros.js` for its usage\n\t */\n\tmacros?: any;\n\t/**\n\t * Specifies a minimum thickness, in ems, for fraction lines,\n\t * \\sqrt top lines, {array} vertical lines, \\hline, \\hdashline,\n\t * \\underline, \\overline, and the borders of \\fbox, \\boxed, and\n\t * \\fcolorbox.\n\t */\n\tminRuleThickness?: number | undefined;\n\t/**\n\t * If `true`, `\\color` will work like LaTeX's `\\textcolor`\n\t * and takes 2 arguments\n\t *\n\t * If `false`, `\\color` will work like LaTeX's `\\color`\n\t * and takes 1 argument\n\t *\n\t * In both cases, `\\textcolor` works as in LaTeX\n\t *\n\t * @default false\n\t */\n\tcolorIsTextColor?: boolean | undefined;\n\t/**\n\t * All user-specified sizes will be caped to `maxSize` ems\n\t *\n\t * If set to Infinity, users can make elements and space\n\t * arbitrarily large\n\t *\n\t * @default Infinity\n\t */\n\tmaxSize?: number | undefined;\n\t/**\n\t * Limit the number of macro expansions to specified number\n\t *\n\t * If set to `Infinity`, marco expander will try to fully expand\n\t * as in LaTex\n\t *\n\t * @default 1000\n\t */\n\tmaxExpand?: number | undefined;\n\t/**\n\t * If `false` or `\"ignore\"`, allow features that make\n\t * writing in LaTex convenient but not supported by LaTex\n\t *\n\t * If `true` or `\"error\"`, throw an error for such transgressions\n\t *\n\t * If `\"warn\"`, warn about behavior via `console.warn`\n\t *\n\t * @default \"warn\"\n\t */\n\tstrict?: boolean | string | Function | undefined;\n\t/**\n\t * If `false` (do not trust input), prevent any commands that could enable adverse behavior, rendering them instead in errorColor.\n\t *\n\t * If `true` (trust input), allow all such commands.\n\t *\n\t * @default false\n\t */\n\ttrust?: boolean | ((context: TrustContext) => boolean) | undefined;\n\t/**\n\t * Place KaTeX code in the global group.\n\t *\n\t * @default false\n\t */\n\tglobalGroup?: boolean | undefined;\n}\n","import katex from 'katex';\nimport type { KatexOptions } from './math';\n/**\n * Renders displayed math\n *\n * Takes a TeX expression and outputs a HTML string for the rendered math in displayed mode\n *\n * @param x TeX expression to be rendered\n * @param options defaults to `{overflowAuto: true, throwOnError: false}`.\n * overflowAuto is a custom option where the default `overflowAuto===true` wraps the generated HTML in a container with `style=\"overflow-x:auto;\"`\n * All KaTeX options are supported, and with the exception of `throwOnError` and `displayMode` are left as default\n *\n * @returns HTML string generated by KaTeX representing displayed math\n *\n * With default options, is equivalent to calling `katex.renderToString(x, {throwOnError: false, displayMode: true})\n * and wrapping it in a container with `style=\"overflow-x:auto;\"`\n */\nexport function display(x: string, options?: KatexOptionsDisplay) {\n\toptions = {\n\t\toverflowAuto: true,\n\t\tthrowOnError: false,\n\t\tdisplayMode: true,\n\t\t...options,\n\t};\n\tlet katexString = katex.renderToString(x, options);\n\tkatexString = options.overflowAuto\n\t\t? `<div style=\"overflow-x:auto;\" class=\"mathlifier-display\">${katexString}</div>`\n\t\t: katexString;\n\treturn katexString;\n}\n\nexport interface KatexOptionsDisplay extends KatexOptions {\n\t/** whether to wrap KaTeX output in a container with style=\"overflow-x: auto\" */\n\toverflowAuto?: boolean;\n}\n","import { display, type KatexOptionsDisplay } from './display';\n\n/**\n * Renders align environment in displayed mode\n *\n * Takes a TeX expression and outputs a HTML string for the rendered math in displayed mode\n *\n * @param x TeX expression to be rendered\n * @param options defaults to `{overflowAuto: true, throwOnError: false}`.\n * overflowAuto is a custom option where the default `overflowAuto===true` wraps the generated HTML in a container with `style=\"overflow-x:auto;\"`\n * All KaTeX options are supported, and with the exception of `throwOnError` and `displayMode` are left as default\n *\n * @returns HTML string generated by KaTeX representing displayed math\n *\n * With default options, is equivalent to\n * wrapping x with `\\\\begin{align} ... \\\\end{align}`, calling\n * `katex.renderToString(x, {throwOnError: false, displayMode: true})\n * and wrapping it in a container with `style=\"overflow-x:auto;\"`\n */\nexport function align(x: string, options?: KatexOptionsDisplay) {\n\toptions = {\n\t\toverflowAuto: true,\n\t\tthrowOnError: false,\n\t\tdisplayMode: true,\n\t\t...options,\n\t};\n\treturn displayEnvironment('align', x, options);\n}\n\n/**\n * Renders align* environment in displayed mode\n *\n * Takes a TeX expression and outputs a HTML string for the rendered math in displayed mode\n *\n * @param x TeX expression to be rendered\n * @param options defaults to `{overflowAuto: true, throwOnError: false}`.\n * overflowAuto is a custom option where the default `overflowAuto===true` wraps the generated HTML in a container with `style=\"overflow-x:auto;\"`\n * All KaTeX options are supported, and with the exception of `throwOnError` and `displayMode` are left as default\n *\n * @returns HTML string generated by KaTeX representing displayed math\n *\n * With default options, is equivalent to\n * wrapping x with `\\\\begin{align*} ... \\\\end{align*}`, calling\n * `katex.renderToString(x, {throwOnError: false, displayMode: true})\n * and wrapping it in a container with `style=\"overflow-x:auto;\"`\n */\nexport function alignStar(x: string, options?: KatexOptionsDisplay) {\n\toptions = {\n\t\toverflowAuto: true,\n\t\tthrowOnError: false,\n\t\tdisplayMode: true,\n\t\t...options,\n\t};\n\treturn displayEnvironment('align*', x, options);\n}\n\n/**\n * Renders alignat environment in displayed mode\n *\n * Takes a TeX expression and outputs a HTML string for the rendered math in displayed mode\n *\n * @param x TeX expression to be rendered\n * @param pairs number of r/l column pairs\n * @param options defaults to `{overflowAuto: true, throwOnError: false}`.\n * overflowAuto is a custom option where the default `overflowAuto===true` wraps the generated HTML in a container with `style=\"overflow-x:auto;\"`\n * All KaTeX options are supported, and with the exception of `throwOnError` and `displayMode` are left as default\n *\n * @returns HTML string generated by KaTeX representing displayed math\n *\n * With default options, is equivalent to\n * wrapping x with `\\\\begin{alignat} ... \\\\end{alignat}`, calling\n * `katex.renderToString(x, {throwOnError: false, displayMode: true})\n * and wrapping it in a container with `style=\"overflow-x:auto;\"`\n */\nexport function alignat(x: string, pairs: number, options?: KatexOptionsDisplay) {\n\tconst alignatOptions = {\n\t\toverflowAuto: true,\n\t\tthrowOnError: false,\n\t\tdisplayMode: true,\n\t\tpostBegin: `{${pairs}}`,\n\t\t...options,\n\t};\n\treturn displayEnvironment('alignat', x, alignatOptions);\n}\n\n/**\n * Renders alignat* environment in displayed mode\n *\n * Takes a TeX expression and outputs a HTML string for the rendered math in displayed mode\n *\n * @param x TeX expression to be rendered\n * @param pairs number of r/l column pairs\n * @param options defaults to `{overflowAuto: true, throwOnError: false}`.\n * overflowAuto is a custom option where the default `overflowAuto===true` wraps the generated HTML in a container with `style=\"overflow-x:auto;\"`\n * All KaTeX options are supported, and with the exception of `throwOnError` and `displayMode` are left as default\n *\n * @returns HTML string generated by KaTeX representing displayed math\n *\n * With default options, is equivalent to\n * wrapping x with `\\\\begin{alignat*} ... \\\\end{alignat*}`, calling\n * `katex.renderToString(x, {throwOnError: false, displayMode: true})\n * and wrapping it in a container with `style=\"overflow-x:auto;\"`\n */\nexport function alignatStar(x: string, pairs: number, options?: KatexOptionsDisplay) {\n\tconst alignatOptions = {\n\t\toverflowAuto: true,\n\t\tthrowOnError: false,\n\t\tdisplayMode: true,\n\t\tpostBegin: `{${pairs}}`,\n\t\t...options,\n\t};\n\treturn displayEnvironment('alignat*', x, alignatOptions);\n}\n\n/**\n * Renders gather environment in displayed mode\n *\n * Takes a TeX expression and outputs a HTML string for the rendered math in displayed mode\n *\n * @param x TeX expression to be rendered\n * @param options defaults to `{overflowAuto: true, throwOnError: false}`.\n * overflowAuto is a custom option where the default `overflowAuto===true` wraps the generated HTML in a container with `style=\"overflow-x:auto;\"`\n * All KaTeX options are supported, and with the exception of `throwOnError` and `displayMode` are left as default\n *\n * @returns HTML string generated by KaTeX representing displayed math\n *\n * With default options, is equivalent to\n * wrapping x with `\\\\begin{gather} ... \\\\end{gather}`, calling\n * `katex.renderToString(x, {throwOnError: false, displayMode: true})\n * and wrapping it in a container with `style=\"overflow-x:auto;\"`\n */\nexport function gather(x: string, options?: KatexOptionsDisplay) {\n\toptions = {\n\t\toverflowAuto: true,\n\t\tthrowOnError: false,\n\t\tdisplayMode: true,\n\t\t...options,\n\t};\n\treturn displayEnvironment('gather', x, options);\n}\n\n/**\n * Renders gather* environment in displayed mode\n *\n * Takes a TeX expression and outputs a HTML string for the rendered math in displayed mode\n *\n * @param x TeX expression to be rendered\n * @param options defaults to `{overflowAuto: true, throwOnError: false}`.\n * overflowAuto is a custom option where the default `overflowAuto===true` wraps the generated HTML in a container with `style=\"overflow-x:auto;\"`\n * All KaTeX options are supported, and with the exception of `throwOnError` and `displayMode` are left as default\n *\n * @returns HTML string generated by KaTeX representing displayed math\n *\n * With default options, is equivalent to\n * wrapping x with `\\\\begin{gather*} ... \\\\end{gather*}`, calling\n * `katex.renderToString(x, {throwOnError: false, displayMode: true})\n * and wrapping it in a container with `style=\"overflow-x:auto;\"`\n */\nexport function gatherStar(x: string, options?: KatexOptionsDisplay) {\n\toptions = {\n\t\toverflowAuto: true,\n\t\tthrowOnError: false,\n\t\tdisplayMode: true,\n\t\t...options,\n\t};\n\treturn displayEnvironment('gather*', x, options);\n}\n\n/**\n * Renders equation environment in displayed mode\n *\n * Takes a TeX expression and outputs a HTML string for the rendered math in displayed mode\n *\n * @param x TeX expression to be rendered\n * @param options defaults to `{overflowAuto: true, throwOnError: false}`.\n * overflowAuto is a custom option where the default `overflowAuto===true` wraps the generated HTML in a container with `style=\"overflow-x:auto;\"`\n * All KaTeX options are supported, and with the exception of `throwOnError` and `displayMode` are left as default\n *\n * @returns HTML string generated by KaTeX representing displayed math\n *\n * With default options, is equivalent to\n * wrapping x with `\\\\begin{equation} ... \\\\end{equation}`, calling\n * `katex.renderToString(x, {throwOnError: false, displayMode: true})\n * and wrapping it in a container with `style=\"overflow-x:auto;\"`\n */\nexport function equation(x: string, options?: KatexOptionsDisplay) {\n\toptions = {\n\t\toverflowAuto: true,\n\t\tthrowOnError: false,\n\t\tdisplayMode: true,\n\t\t...options,\n\t};\n\treturn displayEnvironment('equation', x, options);\n}\n\n/**\n * Renders equation* environment in displayed mode\n *\n * Takes a TeX expression and outputs a HTML string for the rendered math in displayed mode\n *\n * @param x TeX expression to be rendered\n * @param options defaults to `{overflowAuto: true, throwOnError: false}`.\n * overflowAuto is a custom option where the default `overflowAuto===true` wraps the generated HTML in a container with `style=\"overflow-x:auto;\"`\n * All KaTeX options are supported, and with the exception of `throwOnError` and `displayMode` are left as default\n *\n * @returns HTML string generated by KaTeX representing displayed math\n *\n * With default options, is equivalent to\n * wrapping x with `\\\\begin{equation*} ... \\\\end{equation*}`, calling\n * `katex.renderToString(x, {throwOnError: false, displayMode: true})\n * and wrapping it in a container with `style=\"overflow-x:auto;\"`\n */\nexport function equationStar(x: string, options?: KatexOptionsDisplay) {\n\toptions = {\n\t\toverflowAuto: true,\n\t\tthrowOnError: false,\n\t\tdisplayMode: true,\n\t\t...options,\n\t};\n\treturn displayEnvironment('equation*', x, options);\n}\n\nexport const eqn = equation;\nexport const eqnStar = equationStar;\n\nfunction displayEnvironment(env: string, x: string, options?: KatexEnvironmentOptions) {\n\toptions = {\n\t\toverflowAuto: true,\n\t\tthrowOnError: false,\n\t\tdisplayMode: true,\n\t\tpostBegin: '',\n\t\t...options,\n\t};\n\treturn display(\n\t\t`\\\\begin{${env}}${options.postBegin}\n    ${x}\n  \\\\end{${env}}`,\n\t\toptions,\n\t);\n}\n\ninterface KatexEnvironmentOptions extends KatexOptionsDisplay {\n\tpostBegin?: string;\n}\n","export const linebreak = '<br>';\nexport const newline = '<br>';\n\nexport function bold(x: string): string {\n\treturn `<strong>${x}</strong>`;\n}\nexport const strong = bold;\n\nexport function em(x: string): string {\n\treturn `<em>${x}</em>`;\n}\nexport const emph = em;\n\nexport const newParagraph = `<p>`;\n","/**\n * custom html is injected.\n * to be used in conjunction with mathlifier2\n */\nexport function html(x: string): string {\n\treturn x;\n}\n\n/**\n * custom latex is removed for html purposes\n * to be used in conjunction with mathlifier2\n */\nexport function tex(x: string): string {\n\treturn '';\n}\n\n/**\n * inject the relevant html\n * to be used in conjunction with mathlifier2\n */\nexport function htmlTex(x: string, y: string): string {\n\treturn x;\n}\n"]}